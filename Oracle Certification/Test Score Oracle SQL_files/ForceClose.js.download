var fc_inForceClose=false;var fc_delayedShutdown=false;var fc_isErrorShutdown=false;var fc_itsChrome=null;function ITSChrome(a,b,c){this.window=a;this.origin=b;this.secure=c;this.closeBrowser=function(){if(this.window&&this.origin){this.window.postMessage(JSON.stringify({cmd:"closeBrowser"}),this.origin)}};this.exit=function(){if(this.window&&this.origin){this.window.postMessage(JSON.stringify({cmd:"exit"}),this.origin)}};this.goToDefaultUrl=function(){if(this.window&&this.origin){this.window.postMessage(JSON.stringify({cmd:"goToDefaultUrl",params:[]}),this.origin)}};this.goToAltUrl=function(){if(this.window&&this.origin){this.window.postMessage(JSON.stringify({cmd:"goToAltUrl",params:[]}),this.origin)}}}function itdChromeMessage(e){d=JSON.parse(e.data);fc_itsChrome=new ITSChrome(e.source,e.origin,d.secure);var a=new Event('itschromeready');window.dispatchEvent(a)}function forceITSChromeClose(){if(fc_itsChrome!=null){fc_itsChrome.closeBrowser()}else window.setTimeout(function(){forceITSChromeClose()},100)}function forceITSChromeDefaultUrl(){if(fc_itsChrome!=null){fc_itsChrome.goToDefaultUrl()}else window.setTimeout(function(){forceITSChromeDefaultUrl()},100)}function forceITSChromeAltUrl(){if(fc_itsChrome!=null){fc_itsChrome.goToAltUrl()}else window.setTimeout(function(){forceITSChromeAltUrl()},100)}function forceCloseBrowser(){if(arguments.length>forceCloseBrowser.length)fc_isErrorShutdown=arguments[0];if(fc_inForceClose)return;var a=false;var b=0;fc_inForceClose=true;if(typeof itd.CustomExitTest!='function'){var c=false;var d=navigator.userAgent.toLowerCase();var f=d.match("itsmobile");var g=d.match("mac os");var h=d.match("windows");var i=d.match("itschrome");var j=null;if(navigator.userAgent.toLowerCase().indexOf("securebrowser")!=-1)c=true;else{try{c=external.IsSecureBrowser}catch(e){}}if(fc_isErrorShutdown&&typeof(vErrorUrl)!="undefined"&&vErrorUrl!=null&&vErrorUrl.length>0){vCloseAction=4;vCloseUrl=vErrorUrl;fc_isErrorShutdown=false}if(f){if(typeof(itd.ITDGetITSUI)=="function")j=itd.ITDGetITSUI();if(j==null&&typeof(window.plugins)!="undefined"&&typeof(window.plugins.itsUI)!="undefined")j=window.plugins.itsUI;if(j!=null){try{j.hideInfoPanel();j.hideButtonBar();itd.itdMobileButtonBarShown=false;itd.itdMobileInfoPanelShown=false}catch(e){}}}if(typeof vCloseAction!="undefined"){if(!i&&(!c||(!g&&!h))&&(vCloseAction==2||vCloseAction==3))vCloseAction=0;switch(vCloseAction){case 4:if(typeof(vCloseUrl)!="undefined"){try{itd.location.replace(decodeURIComponent(vCloseUrl));return}catch(e){}}break;case 3:if(i){try{forceITSChromeAltUrl();return}catch(e){}}else if(f&&j!=null){try{j.goToAltUrl();return}catch(e){}}else if(g){try{SecureBrowser.GoToAlternateURL();return}catch(e){}}else if(h){try{b=external.GoToAlternateURL();return}catch(e){}}break;case 2:if(i){try{forceITSChromeDefaultUrl();return}catch(e){}}else if(f&&j!=null){try{j.goToDefaultUrl();return}catch(e){}}else if(g){try{SecureBrowser.GoToDefaultURL();return}catch(e){}}else if(h){try{b=external.GoToDefaultURL();return}catch(e){}}break;case 1:break}}if(f&&j!=null){try{j.closeBrowser();return}catch(e){}}if(i){forceITSChromeClose();return}if(d.match("mac os x")&&d.match("applewebkit")){try{if(d.match("securebrowser/")&&!d.match("securebrowser/1")){try{SecureBrowser.CloseBrowser();return}catch(e){}itd.window.close();return}else if(c){if(!fc_delayedShutdown){fc_delayedShutdown=true;fc_inForceClose=false;window.setTimeout(function(){forceCloseBrowser()},1)}else SecureBrowser.closewindow();return}}catch(e){}itd.location.replace('http://www.starttest.com/ENU/close_secure_browser.htm');return}if(!c&&(d.match("applewebkit")||(d.match("firefox")&&(d.match("windows")||d.match("linux"))))){itd.location.replace('http://www.starttest.com/ENU/close_secure_browser.htm');return}try{itd.opener.FinishTest()}catch(e){}try{window.status='quit_preview'}catch(e){}try{external.CloseBrowser()}catch(e){a=true}if(a){try{itd.opener=this}catch(e){}try{itd.open("","itdtop")}catch(e){}itd.close()}}else{itd.CustomExitTest()}}if(navigator.userAgent.toLowerCase().match("itschrome"))window.addEventListener('message',itdChromeMessage);