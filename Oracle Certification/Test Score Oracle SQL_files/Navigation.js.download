function chkNavigation(a,b){var c=0;if(vItemMinimumSelection!=null){if(b>=vItemMinimumSelection[a])c=1}if(vItemAnswerRequired!=null){if(vItemAnswerRequired[a]==1){if(c==1||b==0)navigatePermission[a]=1;else navigatePermission[a]=0}else if(vItemAnswerRequired[a]==2){if(c==1)navigatePermission[a]=1;else navigatePermission[a]=0}else if(vItemAnswerRequired[a]==3){navigatePermission[a]=1}else if(vItemAnswerRequired[a]==4){if(b>0)navigatePermission[a]=1;else navigatePermission[a]=0}else if(vItemAnswerRequired[a]==5){if(c==1)navigatePermission[a]=1;else navigatePermission[a]=0}}}function getAnswerSelectionArray(){var a;var i;var j;var b=new Array();if(vItemTypeList!=null&&vItemTypeList.length>1){if(vItemTypeList.length!=answerSelection.length){itd.ITDAlert(itd.ASLengthMismatch.replace("%itemlength%",vItemTypeList.length.toString()).replace("%answerlength%",answerSelection.length.toString));return 0}b[0]=1;for(i=1;i<vItemTypeList.length;i++){if(vItemTypeList[i]=='LiveApplication'){if(document.forms[0].elements['CMP'+i]=='1')b[i]=1;else b[i]=-1}else if(vItemTypeList[i]=='Essay'||vItemTypeList[i]=='Comment'){if(document.forms[0].elements['EIF'+i]==null){if(document.forms[0].elements['R'+i].value!='')b[i]=1;else b[i]=-1}else{if(document.forms[0].elements['R'+i].value=='1'&&!itdswfuIsUploading)b[i]=1;else b[i]=-1}}else if(vItemTypeList[i]=='Display'||vItemTypeList[i]=='ScoreReport')b[i]=1;else if(vItemTypeList[i]=='InputFraction'){a=document.forms[0].elements['AnswerCountR'+i].value;b[i]=1;for(j=1;j<=a;j++){if(document.forms[0].elements['R'+i+'_'+j+'N'].value==''||document.forms[0].elements['R'+i+'_'+j+'D'].value==''){b[i]=-1;break}}}else if(vItemTypeList[i]=='InputNumber'||vItemTypeList[i]=='InputText'){a=document.forms[0].elements['AnswerCountR'+i].value;b[i]=1;for(j=1;j<=a;j++){if(document.forms[0].elements['R'+i+'_'+j].value==''){b[i]=-1;break}}}else if(vItemTypeList[i]=='OptionSelect'||vItemTypeList[i]=='Matrix'){var c=answerSelection[i].toString();if(c!=null&&c.indexOf(',')!=-1){var d=c.split(',');b[i]=1;for(j=0;j<d.length;j++){if(d[j]==''){b[i]=0;break}}}else b[i]=0}else{b[i]=answerSelection[i]}}}return b}function isPageComplete(){var a=true;var i;if(vItemMinimumSelection!=null){var b=getAnswerSelectionArray();for(i=1;i<b.length;i++){if(b[i]<vItemMinimumSelection[i]){a=false;break}}}return a}function validateNavigation(a){var b=1;var i;if(vItemTypeList!=null&&vItemTypeList.length>1&&vItemTypeList[1]=='RemoteItem'&&typeof(IsValid)=="function"){if(IsValid())b=1;else b=0}else{if(typeof(validateEssayNavigation)=="function"){var c=validateEssayNavigation();b=0;if(vItemAnswerRequired!=null){if(vItemAnswerRequired[1]==1){b=1}else if(vItemAnswerRequired[1]==2&&c){b=1}else if(vItemAnswerRequired[1]==3){b=1}else if(vItemAnswerRequired[1]==4&&c){b=1}else if(vItemAnswerRequired[1]==5&&(c||a!='next')){b=1}}}else if(b==1&&vItemMinimumSelection!=null&&vItemAnswerRequired!=null){var d=getAnswerSelectionArray();for(i=1;i<navigatePermission.length;i++){chkNavigation(i,d[i]);if(navigatePermission[i]==0&&(vItemAnswerRequired[i]!=5||a=='next')){b=0;break}}if(typeof itd.CustomRequirementHandling=="function")b=itd.CustomRequirementHandling(b,a,d,vItemMinimumSelection,vItemAnswerRequired)}}return b}