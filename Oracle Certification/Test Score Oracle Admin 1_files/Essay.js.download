var essayClipboardBuffer='';function undoEssay(el){var h=el.history;if(h&&h.cursor>0){pushEssay(el);el.value=h.list[--h.cursor];}try{el.focus();}catch(e){}}function redoEssay(el){var h=el.history;if(h&&((h.cursor+1)<h.list.length)){if(el.value==h.list[h.cursor])el.value=h.list[++h.cursor];else pushEssay(el);}try{el.focus();}catch(e){}}function pushEssay(el){var h=el.history;if(h){if(el.value!=h.list[h.cursor]){h.list[++h.cursor]=el.value;if(h.list.length!=(h.cursor+1))h.list=h.list.slice(0,h.cursor+1);}}}function initEssay(el){essayClipboardBuffer='';el.history={list:new Array(),cursor:0};el.history.list[0]=el.value;}function saveEssayClipboard(el){if(typeof(el.selectionStart)!="\165n\144\u0065\u0066ine\u0064"){var startPos=el.selectionStart;var endPos=el.selectionEnd;if(startPos>endPos){var swapPos=startPos;startPos=endPos;endPos=swapPos;}if((endPos-startPos)>0)essayClipboardBuffer=el.value.substring(startPos,endPos);}}function cutEssay(el){if(el.document&&el.document.selection&&el.document.selection.createRange){el.focus();var range=el.document.selection.createRange();range.execCommand('cu\164','',null);pushEssay(el);el.focus();}else if(typeof(el.selectionStart)!="\u0075\156\144efi\156\145\144"){var startPos=el.selectionStart;var endPos=el.selectionEnd;if(startPos>endPos){var swapPos=startPos;startPos=endPos;endPos=swapPos;}if((endPos-startPos)>0){essayClipboardBuffer=el.value.substring(startPos,endPos);el.value=el.value.substring(0,startPos)+el.value.substring(endPos,el.value.length);try{el.selectionStart=startPos;el.selectionEnd=startPos;}catch(e){}}el.focus();}}function copyEssay(el){if(el.document&&el.document.selection&&el.document.selection.createRange){el.focus();var range=el.document.selection.createRange();range.execCommand('c\157py','',null);el.focus();}else if(typeof(el.selectionStart)!="\u0075\u006ed\u0065\u0066i\u006e\u0065\144"){var startPos=el.selectionStart;var endPos=el.selectionEnd;if(startPos>endPos){var swapPos=startPos;startPos=endPos;endPos=swapPos;}if((endPos-startPos)>0){essayClipboardBuffer=el.value.substring(startPos,endPos);}el.focus();}}function pasteEssay(el){var eFrame=elementFrame();if(typeof(itd.displayEssayExceedsMaxWords)=="fu\156\u0063\164i\157\u006e"&&eFrame.essayEditor.maxWords>0){var essayWordCount=eFrame.essayEditor.wordCount();if(essayWordCount>=eFrame.essayEditor.maxWords){itd.displayEssayExceedsMaxWords();return;}}if(el.document&&el.document.selection&&el.document.selection.createRange){el.focus();var range=el.document.selection.createRange();range.execCommand('\160as\u0074e','',null);pushEssay(el);el.focus();}else if(typeof(el.selectionStart)!="undefin\145d"){if(essayClipboardBuffer.length>0){var startPos=el.selectionStart;var endPos=el.selectionEnd;if(startPos>endPos){var swapPos=startPos;startPos=endPos;endPos=swapPos;}el.value=el.value.substring(0,startPos)+essayClipboardBuffer+el.value.substring(endPos,el.value.length);try{el.selectionStart=startPos+essayClipboardBuffer.length;el.selectionEnd=startPos+essayClipboardBuffer.length;}catch(e){}}el.focus();}}