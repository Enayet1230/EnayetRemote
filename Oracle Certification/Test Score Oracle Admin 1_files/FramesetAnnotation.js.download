function itdUAMatch(t){var e=navigator.userAgent.toLowerCase().match(t.toLowerCase());return null!=e&&e&&0!=e.length?!0:!1}function itdANGetWebKitVersion(){var t=RegExp("( AppleWebKit/)([^ ]+)").exec(navigator.userAgent);if(!t||t.length<3)return 0;var e=t[2],n=-1!=e.indexOf("+"),a=RegExp("[^\\.0-9]").exec(e);a&&(e=e.slice(0,a.index));var i=e.split(".");return i.isNightlyBuild=n,parseInt(i[0])}function itdANSetChanged(t){try{itdANChanged=!0,t.itdANChanged=!0}catch(e){}}function itdANSavePageChanges(t,e){try{if(t||(t=window,e=""),t.itdIsAnnotationPage&&t.itdANChanged)for(var n=0;n<t.vANPageDataCount;n++){var a=t.vANPageData[n].urid,i=t.itdANGetPageData();itdANSavePageData(a,i),e+=itdANGetPageSaveData(a,i)}}catch(r){}try{if(t.frames.length>0)for(var o=0;o<t.frames.length;o++)try{var d=itdANSavePageChanges(t.frames[o],e);e=d}catch(r){}}catch(r){}return e}function itdANSaveChanges(){if(itdANChanged){try{var t=itdANSavePageChanges(),e=elementFrame();e&&(e.document.forms["ITD-ITEM"].Annotations.value=t)}catch(n){}itdANChanged=!1}}function itdANSetUnchanged(t){try{t||(t=window),t.itdANChanged&&(t.itdANChanged=!1)}catch(e){}try{if(t.frames.length>0)for(var n=0;n<t.frames.length;n++)try{itdANSetUnchanged(t.frames[n])}catch(e){}}catch(e){}}function itdANApplyAnnotations(t){try{for(var e=!0,n=0;n<t.vANPageDataCount;n++){var a=itdANGetPageData(t.vANPageData[n].urid);a&&(t.itdANSetPageData(a,e),e=!1)}}catch(i){}}function itdANGetPageDataIndex(t){for(var e=0;e<itdANData.length;e++)if(itdANData[e].urid==t)return e;return-1}function itdANSavePageData(t,e){var n=itdANGetPageDataIndex(t);n>=0?itdANData[n].data=e:(n=itdANData.length,itdANData[n]={urid:t,data:e})}function itdANGetPageData(t){var e=itdANGetPageDataIndex(t);return e>=0?itdANData[e].data:null}function itdANGetPageSaveData(t,e){var n='{urid:"'+t+'", data:new Array(',a=0,i=0,r=0,o="";for(a=0;a<e.length;a++)n+="\r\n"+o+'{type:"'+e[a].type+'"',"hl"==e[a].type?(r++,n+=',fc:decodeURIComponent("'+encodeURIComponent(e[a].fc)+'"),count:'+e[a].count+",len:"+e[a].len+",idx:"+e[a].idx+"}",o=","):("nt"==e[a].type||"ni"==e[a].type)&&(i++,n+=',ref:"'+e[a].ref+'"',n+="t"==e[a].ref?',lc:decodeURIComponent("'+encodeURIComponent(e[a].lc)+'"),count:'+e[a].count:',tag:"'+e[a].tag+'",count:'+e[a].count,n+=',txt:decodeURIComponent("'+encodeURIComponent(e[a].txt)+'")}',o=",");return n+="\r\n)}",n='<AN urid="'+t+'" nc="'+i+'" hc="'+r+'"><![CDATA['+n+"]]></AN>"}function itdGetSelectionObject(t){var e;return window.getSelection?e=t.getSelection():document.selection&&(e=t.document.selection.createRange()),e}function itdGetRangeObject(t,e){if(t){if(!t.getRangeAt){var n=e.createRange();return n.setStart(t.anchorNode,t.anchorOffset),n.setEnd(t.focusNode,t.focusOffset),n.startContainer==n.endContainer&&n.startOffset==n.endOffset&&(n.setStart(t.focusNode,t.focusOffset),n.setEnd(t.anchorNode,t.anchorOffset)),n}try{return t.getRangeAt(0)}catch(a){}}return null}function itdGetRangeSelectionObject(t,e){return window.getSelection&&(t=itd.itdGetRangeObject(t,e)),t}var itdANChanged=!1;String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")},String.prototype.ltrim=function(){return this.replace(/^\s+/,"")},String.prototype.rtrim=function(){return this.replace(/\s+$/,"")},itdUAMatch("msie")||(document.createRange().__proto__.surroundContents=function(t){var e=this.extractContents();null!=e&&t.appendChild(e),this.insertNode(t),this.selectNode(t)});var itdANIsWebKit=RegExp(" AppleWebKit/").test(navigator.userAgent),itdANWKVersion=itdANGetWebKitVersion(),itdIsIE=document.all&&!document.documentMode||document.documentMode<9,itdIsFireFox=itdUAMatch("firefox"),itdIsGecko=itdUAMatch("gecko"),itdHLUseBestMethod=itdIsIE;