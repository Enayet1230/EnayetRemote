var blnWorkShopPreview=false;var ITDFinishedInit=false;var vImgErrorArray=new Array();var vSpriteErrorOccurred=new Array();var vImgErrorOccurred=new Array();function ITDImageError(d,e,f){d.onerror=null;if(!vImgErrorArray[e]||vImgErrorArray[e]<2){if(vImgErrorArray[e])vImgErrorArray[e]++;else vImgErrorArray[e]=1;itd.addAction(10001,0,"Retrying image: "+f,false)}else{itd.fatalSystemError('4001','','Error loading image.',f,0);return true}if(typeof(itd.ITDResetLoadingCheckTime)=="function")itd.ITDResetLoadingCheckTime();$(d).attr('src',ITDNewSpriteUrl(d.src,e)).waitForImages(function(){if(vImgErrorOccurred[e]){ITDImageError(d,e,f)}},function(a,b,c){if(!c){vImgErrorOccurred[e]=true}},2);return true}function ITDNewSpriteUrl(a,b){var c=navigator.userAgent.toLowerCase().match("msie")||navigator.userAgent.toLowerCase().match("rv:");if(c==null||!c||c.length==0)return a;var d=a.indexOf("try=");if(d>=0){d+=4;var e=a.indexOf("&",d);if(e)return a.substr(0,d+1)+b.toString()+a.substr(e)}else{var f=a.indexOf("?");if(f>=0)return a.substr(0,f+1)+"try="+b.toString()+"&"+a.substr(f+1)}return a}function ITDLoadSpriteImage(d,e,f,g){vSpriteErrorOccurred[g]=false;$(d).css('background-image','none').css('background-repeat','no-repeat').css('background-image','url("'+e+'")').waitForImages(function(){if(vSpriteErrorOccurred[g]){if(!vImgErrorArray[g]||vImgErrorArray[g]<2){if(vImgErrorArray[g])vImgErrorArray[g]++;else vImgErrorArray[g]=1;ITDLoadSpriteImage(d,ITDNewSpriteUrl(e,g),f,g)}else{itd.fatalSystemError('4002','','Error loading image sprite.',f,0)}}},function(a,b,c){if(!c){vSpriteErrorOccurred[g]=true}},1)}function ITDLoadSpriteImage(d,e,f,g){vSpriteErrorOccurred[g]=false;$(d).css('background-image','none').css('background-repeat','no-repeat').css('background-image','url("'+e+'")').waitForImages(function(){if(vSpriteErrorOccurred[g]){if(!vImgErrorArray[g]||vImgErrorArray[g]<2){if(vImgErrorArray[g])vImgErrorArray[g]++;else vImgErrorArray[g]=1;ITDLoadSpriteImage(d,ITDNewSpriteUrl(e,g),f,g)}else{itd.fatalSystemError('4002','','Error loading image sprite.',f,0)}}},function(a,b,c){if(!c){vSpriteErrorOccurred[g]=true}},true)}function untrappedSystemError(a,b,l){if(typeof itd.fatalSystemError!='undefined')itd.fatalSystemError('5002','',a,b,l);else{if(typeof itd.CEClose!='undefined')itd.ITDAlert(itd.CEClose);else if(typeof itd.ITDAlert!='undefined')itd.ITDAlert('A communications error has occurred. This error requires you to restart your test.  Your test will restart to the last question you have seen and no data or time will be lost.  When you click OK, your test will be closed.  If you continue to have problems, please try closing and reopening your browser.  You may also want to restart your machine.');else alert('A communications error has occurred. This error requires you to restart your test.  Your test will restart to the last question you have seen and no data or time will be lost.  When you click OK, your test will be closed.  If you continue to have problems, please try closing and reopening your browser.  You may also want to restart your machine.');forceCloseBrowser(true)}return true}window.onerror=untrappedSystemError;function ITDGetElementValue(a){var b=document.getElementById(a);if(b!=null&&typeof b.value!="undefined")return b.value;return""}function ITDCheckCutCopyPaste(e){var a=null;if(e.target)a=e.target;else if(e.srcElement)a=e.srcElement;if(a&&typeof(a.tagName)!="undefined"&&(a.tagName=="TEXTAREA"||(a.tagName=="INPUT"&&(a.type=="text"||a.type=="email"||a.type=="search"||a.type=="password"||a.type=="number"||a.type=="tel"))))return true;return false}function ITDFirstAction(){if(typeof(vFailedScripts)!="undefined"&&vFailedScripts.length>0&&typeof(itd.fatalSystemError)=="function"){itd.fatalSystemError("1102","","Unable to load the following scripts: "+vFailedScripts.join(", "),window.location.href,0);return}if(typeof ITDDynamicOnLoad=='function')ITDDynamicOnLoad();if(typeof blockKeys=="function"){if(typeof itd.ITDGetBrowser!="undefined"){if(itd.ITDGetBrowser()==2&&parseInt(navigator.appVersion)<=4)document.addEventListener("keypress",blockKeys,true);else if(itd.ITDGetBrowser()==3&&itd.ITDGetOperatingSystem()==1&&navigator.userAgent.indexOf("1.3")!=-1)document.onkeypress=blockKeys;else document.onkeydown=blockKeys}else document.onkeydown=blockKeys}if(typeof resetLastActivity=="function"){if(typeof itd.ITDGetBrowser!="undefined"&&itd.ITDGetBrowser()==2&&parseInt(navigator.appVersion)<=4)document.addEventListener("click",resetLastActivity,true);else document.onclick=resetLastActivity}if(itd.location.href.indexOf('Containers=')!=-1)blnWorkShopPreview=true;document.onhelp=function(){event.cancelBubble=true;event.returnValue=false};if(itd.blnBlockEscape==null)itd.blnBlockEscape=true;if(typeof PageLoadScript=="function")PageLoadScript();if(typeof InitializePage=="function")InitializePage();if(typeof(itdANAnnotatePage)=="function")itdANAnnotatePage();if(typeof(itdSetupDisableSelection)=="function")itdSetupDisableSelection(document);if(document.body.getAttribute("oncut")!=null){document.body.oncut=function(e){return ITDCheckCutCopyPaste(e)}}if(document.body.getAttribute("oncopy")!=null){document.body.oncopy=function(e){return ITDCheckCutCopyPaste(e)}}if(document.body.getAttribute("onpaste")!=null){document.body.onpaste=function(e){return ITDCheckCutCopyPaste(e)}}ITDFinishedInit=true}